spring.application.name=mvt-events

# Disable Docker Compose
spring.docker.compose.enabled=false

# Database Configuration (with environment variable support)
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5435/mvt-events}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:mvt}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:mvtpass}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:true}
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true

# Timezone Configuration
# Aplicação e banco trabalham com America/Fortaleza (UTC-3)
# Evita conversão dupla de timezone com LocalDateTime
spring.jpa.properties.hibernate.jdbc.time_zone=America/Fortaleza
spring.jackson.time-zone=America/Fortaleza
spring.jackson.serialization.write-dates-as-timestamps=false

# Logging Configuration for debugging
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.hibernate.orm.jdbc.bind=TRACE
logging.level.com.mvt.mvt_events.tenant=DEBUG

# AOP Configuration for Tenant Filtering
spring.aop.auto=true
spring.aop.proxy-target-class=true

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.validate-on-migrate=true
spring.flyway.locations=classpath:db/migration

# JWT Configuration (Development defaults - override in production with environment variables)
jwt.secret=${JWT_SECRET:mvt-events-secret-key-for-jwt-authentication-very-long-secret-key-256-bits}
jwt.expiration=${JWT_EXPIRATION:18000}

# Security Configuration - Allow all access for development
spring.security.user.name=admin
spring.security.user.password=admin

# Actuator Security Configuration
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.endpoints.web.base-path=/actuator
management.health.mail.enabled=false

# Server Configuration
server.address=0.0.0.0
server.port=${SERVER_PORT:8080}

# Tomcat Configuration - Fix for "Request header is too large"
server.tomcat.max-http-response-header-size=65536
server.max-http-request-header-size=65536

# Payment Configuration
# Default payment provider: STRIPE, MERCADOPAGO, or PAYPAL
payment.provider=${PAYMENT_PROVIDER:STRIPE}

# Stripe Configuration
payment.stripe.public-key=${STRIPE_PUBLIC_KEY:pk_test_PLACEHOLDER_REPLACE_WITH_REAL_KEY}
payment.stripe.secret-key=${STRIPE_SECRET_KEY:sk_test_PLACEHOLDER_REPLACE_WITH_REAL_KEY}
# Webhook secret do Stripe CLI
payment.stripe.webhook-secret=${STRIPE_WEBHOOK_SECRET:whsec_PLACEHOLDER_REPLACE_WITH_REAL_SECRET}

# MercadoPago Configuration
payment.mercadopago.public-key=${MERCADOPAGO_PUBLIC_KEY:}
payment.mercadopago.access-token=${MERCADOPAGO_ACCESS_TOKEN:}
payment.mercadopago.webhook-secret=${MERCADOPAGO_WEBHOOK_SECRET:}

# PayPal Configuration
payment.paypal.client-id=${PAYPAL_CLIENT_ID:}
payment.paypal.client-secret=${PAYPAL_CLIENT_SECRET:}
payment.paypal.environment=${PAYPAL_ENVIRONMENT:sandbox}

# Payment URLs (used for redirects and webhooks)
payment.return-url=${PAYMENT_RETURN_URL:http://localhost:3000/payment/success}
payment.cancel-url=${PAYMENT_CANCEL_URL:http://localhost:3000/payment/cancel}
payment.webhook-url=${PAYMENT_WEBHOOK_URL:http://localhost:8080/api/payments/webhook}

# Push Notifications Configuration (Expo)
# Token de produção configurado
expo.access-token=${EXPO_ACCESS_TOKEN:q_E_RBFanVt2NfWO2isuYFwEZ1u3d2sxdiagNFRZ}
expo.push-url=${EXPO_PUSH_URL:https://exp.host/--/api/v2/push/send}

# Web Push Notifications Configuration (VAPID)
# Chaves no formato base64url raw (correto para Web Push)
webpush.vapid.public-key=${VAPID_PUBLIC_KEY:BN8ym6-oByG6GoAEC9399ciwUoal_2vh1IyGph1xS9rnF0yC5GPHfrlgE-th3JqyPPaFOqXKnfQBYVj9oS5a15k}
webpush.vapid.private-key=${VAPID_PRIVATE_KEY:FADUse7iqBxTm1aqOjxgOAwZpg0pL3c-oElOw0Zxbjw}
webpush.vapid.subject=${VAPID_SUBJECT:mailto:admin@mvt-events.com}

# Push Notifications Logging
logging.level.com.mvt.mvt_events.service.PushNotificationService=DEBUG
logging.level.com.mvt.mvt_events.service.UserPushTokenService=DEBUG

# ============================================
# Pagar.me Payment Gateway Configuration
# ============================================
# Documentação: https://docs.pagar.me/reference/API-overview
# Dashboard: https://dash.pagar.me
# Webhook: Configurar no Dashboard para apontar para /api/webhooks/pagarme

# Pagar.me API Configuration
# Endpoint: https://api.pagar.me/core/v5
pagarme.api.url=${PAGARME_API_URL:https://api.pagar.me/core/v5}

# Secret Key (usada para autenticação Basic Auth)
# Sandbox: sk_test_XXXXXXXX
# Produção: sk_XXXXXXXX
# User: secretKey | Password: vazio
pagarme.api.key=${PAGARME_API_KEY:sk_test_752320aa308248e58f926f3ca210fc11}

# Webhook Configuration (HMAC SHA256)
# Secret usado para validar webhooks
pagarme.webhook.secret=${PAGARME_WEBHOOK_SECRET:PLACEHOLDER_WEBHOOK_SECRET}

# Split Payment Configuration (percentages without decimals)
# 87% para o motoboy, 5% para o gerente, 8% para a plataforma (automático)
pagarme.split.courier-percentage=${PAGARME_SPLIT_COURIER:8700}
pagarme.split.manager-percentage=${PAGARME_SPLIT_MANAGER:500}

# Split Rules Configuration
# ZAPI10 (plataforma) é "liable" (responsável por chargebacks)
# ZAPI10 paga TODAS as taxas de processamento
# Motoboy e Manager recebem valores líquidos (sem desconto de taxas)
pagarme.split.courier-liable=${PAGARME_COURIER_LIABLE:false}
pagarme.split.courier-charge-processing-fee=${PAGARME_COURIER_CHARGE_FEE:false}
pagarme.split.manager-charge-processing-fee=${PAGARME_MANAGER_CHARGE_FEE:false}

# Retry Configuration for API calls
pagarme.retry.max-attempts=${PAGARME_RETRY_MAX_ATTEMPTS:3}
pagarme.retry.initial-backoff-ms=${PAGARME_RETRY_INITIAL_BACKOFF:1000}

# Pagar.me Logging
logging.level.com.mvt.mvt_events.payment.service.PagarMeService=DEBUG

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
# Provedor de email: RESEND ou AWS_SES
# Padrão: RESEND (mais fácil de configurar)
# Para usar AWS SES: configure email.provider=AWS_SES
email.provider=${EMAIL_PROVIDER:RESEND}

# ============================================================================
# RESEND Configuration (recomendado)
# ============================================================================
# Documentação: https://resend.com/docs
resend.api-key=${RESEND_API_KEY:re_jdyM5ysn_9FBaFvkbcCFoh3RmhdJ9foR1}
resend.from-email=${RESEND_FROM_EMAIL:suporte@zapi10.com.br}
resend.from-name=${RESEND_FROM_NAME:Zapi10}
resend.enabled=${RESEND_ENABLED:true}

# ============================================================================
# AWS SES Configuration (alternativo)
# ============================================================================
# Para usar AWS SES, configure: EMAIL_PROVIDER=AWS_SES
# E forneça as credenciais abaixo
aws.ses.access-key=${AWS_SES_ACCESS_KEY:}
aws.ses.secret-key=${AWS_SES_SECRET_KEY:}
aws.ses.region=${AWS_SES_REGION:us-east-2}
aws.ses.from-email=${AWS_SES_FROM_EMAIL:suporte@zapi10.com.br}
aws.ses.from-name=${AWS_SES_FROM_NAME:Zapi10}
aws.ses.enabled=${AWS_SES_ENABLED:false}

# App URLs
app.name=${APP_NAME:Zapi10}
app.frontend.url=${FRONTEND_URL:http://localhost:5173}
app.backend.url=${BACKEND_URL:http://localhost:8080}
